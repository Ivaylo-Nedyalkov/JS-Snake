<!DOCTYPE html>
<html lang="en-US">
<head>
    <title>SnakeGame</title>
<!-- <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.2.min.js"></script>
    <script type="text/javascript" src="script.js"></script> -->
</head>
<body bgcolor="#99ebff">
    <h2 align="center">Snake Game</h2>
 <button onclick="init()" style="background-color: green; width: 49%; height: 50px">
Play</button>


	    <div id="canvas-container" align="center">
	        <canvas id="canvas" width="450" height="450"></canvas>
	    </div>

    <script type="text/javascript">

    	var canvas = document.getElementById("canvas");
    	var ctx = canvas.getContext("2d");
    	var h = canvas.height;
    	var w = canvas.width;

    	var cw = 10;
    	var direction;
    	var food;
    	var score;

    	var snake;

    	function init () {
    		direction = "right";
    		create_snake();
    		create_food();
    		score = 0;

    		if (typeof game_loop != "undefined") {
    			clearInterval(game_loop);
    		}
    		game_loop = setInterval(paint, 60);
    	}
    	
    	function create_snake() {
    		var lenght = 5;
    		snake = [];
    		for (var i = lenght - 1; i >= 0; i-- ) {
    			snake.push({x: i, y: 0})
    		}
    	}

		function paint() {
			console.log("awge");
			ctx.fillStyle = "white";
			ctx.fillRect(0, 0, w, h);
			ctx.strokeStyle = "black";
			ctx.strokeRect(0, 0, w, h);

			var nx = snake[0].x;
			var ny = snake[0].y;

			if (direction == "right" && direction !="left") { nx++ }
			else if (direction == "left" && direction != "right") {nx--}
			else if (direction == "up" && direction != "down") {ny--}
			else if (direction == "down" && direction != "up") {ny++}

			if (nx == -1 || nx == w/cw || ny == -1 || ny == h/cw || check_collision(nx, ny, snake)) {
				//init();
				snake = [];
				alert("GAME OVER");
				//return;
				// IMA ZA DOBAVQNE
			}

			if (nx == food.x && ny == food.y) {
				var tail = {
					x: nx,
					y: ny
				};
				score++;
				create_food();
			}
			else {
				var tail = snake.pop();
				tail.x = nx;
				tail.y = ny;
			}

			snake.unshift(tail);

			for (var i = 0; i < snake.length; i++) {
				var c = snake[i];
				paint_cell(c.x, c.y);
			}

			paint_cell(food.x, food.y);
			var score_text = "Score:" + score;
			ctx.fillText(score_text, 5, h-5);
    	}


    	function create_food() {
    		food = {
    			x: Math.round(Math.random()*(w-cw)/cw),
    			y: Math.round(Math.random()*(h-cw)/cw)
    		}
    	}

    	function paint_cell(x, y) {
    		ctx.fillStyle = "blue";
    		ctx.fillRect(x*cw, y*cw, cw, cw);
    		ctx.strokeStyle = "white";
    		ctx.strokeRect(x*cw, y*cw, cw, cw)
    	}

    	function check_collision(x, y, array) {
    		for (var i = 0; i < array.lenth; i++) {
    			if (array[i].x == x && array[i].y == y) {
    				return true;
    			}
    			return false;
    		}
			document.onkeydown = function(e){
				var key = e.which;

				if (key == "37" && direction != "right") {
					direction = "left";
				}
				else if (key == "38" && direction != "down") {
					direction = "up";
				}
				else if (key == "39" && direction != "left") {
					direction = "right";
				}
				else if (key == "40" && direction != "up") {
					direction = "down";
				}
    		}
    	
    	}

    </script>
</body>
</html>